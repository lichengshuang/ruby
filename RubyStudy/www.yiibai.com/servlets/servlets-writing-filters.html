<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<meta http-equiv="Content-Language" content="zh-CN"/>
		<title>Servlets Filters</title>
		<meta name="Keywords" content="Servlets,Servlets Filters,Servlets-"/>
		<meta name="Description" content="Servlets Filters"/>
		<!--//tutorial/base.view.html-->
		<script type="text/javascript" src="../static/js/jquery.js"></script>
		<link rel="stylesheet" href="http://www.yiibai.com/static/redactor/css/redactor.css" />
		<script src="http://www.yiibai.com/static/redactor/redactor.js"></script>
		<link href="../static/css/bootstrap.css" rel="stylesheet" type="text/css" />
		<link href="../static/css/tutorial.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript">
			$(document).ready(function() {
				var buttons = ['formatting', '|', 'bold', 'italic', '|', 'button1'];
				$('#comment_textarea').redactor({
					focus: false, 
					buttons: buttons, 					
				});
			});
		</script>
		<style>
			table {
				border: 1px solid #DDD;
				border-collapse: separate;
				border-left: 0;
				-webkit-border-radius: 4px;
				-moz-border-radius: 4px;
				border-radius: 4px;
				max-width: 90%;
				background-color: transparent;
				border-collapse: collapse;
				border-spacing: 0;
			}
			thead {
				display: table-header-group;
				vertical-align: middle;
				border-color: inherit;
				border-left: 1px solid #DDD;
			}
			th {
				font-weight: bold;
				border-left: 1px solid #DDD;
				line-height: 28px;
			}
			tbody {
				display: table-row-group;
				vertical-align: middle;
				border-color: inherit;
			}
			tr {
				display: table-row;
				vertical-align: inherit;
				border-color: inherit;
				border-left: 1px solid #DDD;
			}
			td {
				padding: 8px;
				line-height: 20px;
				text-align: left;
				vertical-align: top;
				border-top: 1px solid #DDD;
				border-left: 1px solid #DDD;
			}
		</style>
	</head>
	<body>
		<div class="header">
	<a href="../index.html" class="logo"> <img src="../static/img/logo.png" /> </a>
	<span class="input-append search" style="">
	<form action="http://www.yiibai.com/search" method="get" style="margin: 0px;">
		<input id="prependedDropdownButton" type="text" name="kw" class="span4 pub-share">
		<button class="btn pub-share" type="submit">
			搜 索
		</button>
	</form>
	</span>
	<a class="btn btn-success" href="../index.php?r=tutorial%252Fcreate">发起分享</a>
		<a href="../index.php?r=login" class="user-login">登陆</a>
	<a href="../index.php?r=register" class="user-register">注册</a>
	
		</span>
</div>


		<div class="header-nav">	<div id="menu" class="menu">		<div class="main-menu" style="clear:both;">			<ul>				<li class="">					<a href="../index.html" target="_self">首页</a>				</li>				<li id="all-category-e" class="all-category current">					<a href="http://www.yiibai.com/tutorial"  class="all-category current">教程</a>				</li>				<li>					<a href="http://www.yiibai.com/question">问题求助</a>				</li>				<li class="last">					<a class="last" href="http://www.yiibai.com/tag">标签</a>				</li>			</ul>		</div>	</div></div>
		<div class="exp-category-container">
	<ul class="exp-category-list clearfix">
		<li>
			<a href="../java" target="_blank" title="Java教程">Java</a>
		</li>
		<li>
			<a href="../python" target="_blank" title="Python教程">Python</a>
		</li>
		<li>
			<a href="../php" target="_blank" title="php教程">PHP</a>
		</li>
		<li>
			<a href="../perl" target="_blank" title="perl教程">Perl</a>
		</li>
		<li>
			<a href="../ruby.2" target="_blank" title="Ruby教程">Ruby</a>
		</li>
		<li>
			<a href="../mysql" target="_blank" title="MySQL教程">MySQL</a>
		</li>
		<li>
			<a href="../sql" target="_blank" title="SQL教程">SQL</a>
		</li>
		<li>
			<a href="../jdbc" target="_blank" title="JDBC教程">JDBC</a>
		</li>
		<li>
			<a href="../go" target="_blank" title="GO教程">Go语言</a>
		</li>
		
	</ul>
</div>
		<div class="container-fluid" style="width: 1080px;margin: auto; margin-top: 16px;">
			<div class="path" style="padding-top:2px; margin-top: 0px;margin-bottom: 14px;clear: both;">
				当前位置：<a href="../index.html">首页</a> » <a href="index.html">Servlet教程</a> » 
			</div>
			<div class="row-fluid">
				<div class="well span3" style="width:260px;">
					<ul class="nav nav-list">
						<li class="">
							<a href="index.html" style="font-size:12pt;">Servlet教程</a>
						</li>
						<li class="divider" style="margin-top: 0px;"></li>
																		<li style="padding-left: 8px;">
														<a href="servlets-overview.html">Servlets 概述</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-environment-setup.html">Servlets环境设置</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-life-cycle.html">Servlets Life Cycle</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-first-example.html">Servlets First Examples</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-form-data.html">Servlets Form Data</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-client-reques.html">Servlets Client HTTP Request</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-server-response.html">Servlets Server HTTP Response</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-http-status-codes.html">Servlets HTTP 1.1 Status Codes</a>
													</li>
																								<li class="active" style="font-size:11pt;padding-left: 8px;">
														<a href="servlets-writing-filters.html">Servlets Filters</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-exception-handling.html">Servlet Exception Handling</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-cookies-handling.html">Servlets Cookies Handling</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-session-tracking.html">Servlet Session Tracking</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-database-access.html">Servlets - Database Access</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-file-uploading.html">Servlet File Uploading</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-handling-date.html">Servlet Date Handling</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-page-redirec.html">Servlets Page Redirection</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-hits-counter.html">Servlets Page Hits Counter</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-auto-refres.html">Auto Page Refresh using Servlets</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-sending-email.html">Sending email using Servlets</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-packaging.html">Servlets Packaging</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-debugging.html">Servlets Debugging</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-internationalization.html">Servlets Internationalization| i18n| l10n| Servlets Localization</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="../index.html">Servlets Quick Guide</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-useful-resources.html">Servlets Useful Resources, Sites and Books</a>
													</li>
																	</ul>
				</div>
				<div class="span9" style="width:800px; margin-left:12px; padding: 0px; border: 1px solid #DDDDDD;float:left;">
					<div style="width: 760px;height:48px; padding: 2px 18px 2px 18px;text-align: left;border-bottom: 1px dashed #CCC;clear:both; ">
						<h1 style="font-size: 13.5pt;width: 645px;float:left; overflow: hidden;">Servlets - Writing Filters</h1>
						<span style="float:left;padding: 18px;margin-left: 12px;"><a href="servlets-writing-filters.html#comment" title="我要去评论">评论</a>&nbsp;&nbsp;<a href="http://www.yiibai.com/index.php?r=tutorial/updateVersion&id=3628" title="完善此教程实例">编辑</a></span>
						<input type="hidden" id="tid" value="3628"/>
					</div>

					<!--
					<div style="padding-left:24px; padding-top: 12px;padding-bottom: 2px;">
					<script type="text/javascript">
					<!--
					google_ad_client ="ca-pub-1090193214637198";
					/* yiibai上方 */
					google_ad_slot = "7899237394";
					google_ad_width = 728;
					google_ad_height = 90;
					//->
					</script>
					<script type="text/javascript"
					src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
					</div>
					-->
					<div id="baidu-ad" style="float:left;clear:both; width: 800px;padding-left:24px; padding-top: 6px;padding-bottom: 24px;">
						<script type="text/javascript">
						/*文章详细页上方628*90*/
						var cpro_id = "u1064372";
						</script>
						<script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
						
					</div>
					<div style="padding:8px 22px 8px 24px;" id="content">
						<p>Servlet Filters are Java classes that can be used in Servlet Programming for the following purposes:</p>
<ul class="list">
<li><p>To intercept requests from a client before they access a resource at back end.</p></li>
<li><p>To manipulate responses from server before they are sent back to the client.</p></li>
</ul>
<p>There are are various types of filters suggested by the specifications:</p>
<ul class="list">
<li><p>Authentication Filters.</p></li>
<li><p>Data compression Filters. </p></li>
<li><p>Encryption Filters.</p></li>
<li><p>Filters that trigger resource access events.</p></li>
<li><p>Image Conversion Filters.</p></li>
<li><p>Logging and Auditing Filters.</p></li> 
<li><p>MIME-TYPE Chain Filters.</p></li>
<li><p>Tokenizing Filters .</p></li>
<li><p>XSL/T Filters That Transform XML Content.</p></li> 
</ul>
<p>Filters are deployed in the deployment descriptor file <b>web.xml </b> and then map to either servlet names or URL patterns in your application's deployment descriptor.</p>
<p>When the web container starts up your web application, it creates an instance of each filter that you have declared in the deployment descriptor. The filters execute in the order that they are declared in the deployment descriptor.</p>
<h2>Servlet Filter Methods:</h2>
<p>A filter is simply a Java class that implements the javax.servlet.Filter interface. The javax.servlet.Filter interface defines three methods:</p>
<table class="src">
<tr><th style="width:5%">S.N.</th><th>Method &amp; Description</th></tr>
<tr><td>1</td><td><b>public void doFilter (ServletRequest, ServletResponse, FilterChain)</b><br />This method is called by the container each time a request/response pair is passed through the chain due to a client request for a resource at the end of the chain.</td></tr>
<tr><td>2</td><td><b>public void init(FilterConfig filterConfig)</b><br />This method is called by the web container to indicate to a filter that it is being placed into service.</td></tr>
<tr><td>3</td><td><b>public void destroy()</b><br />This method is called by the web container to indicate to a filter that it is being taken out of service.</td></tr>
</table>
<h2>Servlet Filter Example:</h2>
<p>Following is the Servlet Filter Example that would print the clients IP address and current date time. This example would give you basic understanding of Servlet Filter, but you can write more sophisticated filter applications using the same concept:</p>
<pre class="prettyprint">
// Import required java libraries
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import java.util.*;

// Implements Filter class
public class LogFilter implements Filter  {
   public void  init(FilterConfig config) 
                         throws ServletException{
      // Get init parameter 
      String testParam = config.getInitParameter("test-param"); 

      //Print the init parameter 
      System.out.println("Test Param: " + testParam); 
   }
   public void  doFilter(ServletRequest request, 
                 ServletResponse response,
                 FilterChain chain) 
                 throws java.io.IOException, ServletException {

      // Get the IP address of client machine.   
      String ipAddress = request.getRemoteAddr();

      // Log the IP address and current timestamp.
      System.out.println("IP "+ ipAddress + ", Time "
                                       + new Date().toString());

      // Pass request back down the filter chain
      chain.doFilter(request,response);
   }
   public void destroy( ){
      /* Called before the Filter instance is removed 
      from service by the web container*/
   }
}
</pre>
<p>Compile <b>LogFilter.java</b> in usual way and put your class file in &lt;Tomcat-installation-directory&gt;/webapps/ROOT/WEB-INF/classes.</p>
<h2>Servlet Filter Mapping in Web.xml:</h2>
<p>Filters are defined and then mapped to a URL or Servlet, in much the same way as Servlet is defined and then mapped to a URL pattern. Create the following entry for filter tag in the deployment descriptor file <b>web.xml </b></p>
<pre class="prettyprint">
&lt;filter&gt;
   &lt;filter-name&gt;LogFilter&lt;/filter-name&gt;
   &lt;filter-class&gt;LogFilter&lt;/filter-class&gt;
   &lt;init-param&gt;
	  &lt;param-name&gt;test-param&lt;/param-name&gt;
	  &lt;param-value&gt;Initialization Paramter&lt;/param-value&gt;
   &lt;/init-param&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
   &lt;filter-name&gt;LogFilter&lt;/filter-name&gt;
   &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
</pre>
<p>The above filter would apply to all the servlets because we specified <b>/*</b> in our configuration. You can specicy a particular servlet path if you want to apply filter on few servlets only.</p>
<p>Now try to call any servlet in usual way and you would see generated log in your web server log. You can use Log4J logger to log above log in a separate file.</p>
<h2>Using Multiple Filters:</h2>
<p>Your web application may define several different filters with a specific purpose. Consider, you define two filters <i>AuthenFilter</i> and <i>LogFilter</i>. Rest of the process would remain as explained above except you need to create a different mapping as mentioned below:</p>
<pre class="prettyprint">
&lt;filter&gt;
   &lt;filter-name&gt;LogFilter&lt;/filter-name&gt;
   &lt;filter-class&gt;LogFilter&lt;/filter-class&gt;
   &lt;init-param&gt;
	  &lt;param-name&gt;test-param&lt;/param-name&gt;
	  &lt;param-value&gt;Initialization Paramter&lt;/param-value&gt;
   &lt;/init-param&gt;
&lt;/filter&gt;

&lt;filter&gt;
   &lt;filter-name&gt;AuthenFilter&lt;/filter-name&gt;
   &lt;filter-class&gt;AuthenFilter&lt;/filter-class&gt;
   &lt;init-param&gt;
	  &lt;param-name&gt;test-param&lt;/param-name&gt;
	  &lt;param-value&gt;Initialization Paramter&lt;/param-value&gt;
   &lt;/init-param&gt;
&lt;/filter&gt;

&lt;filter-mapping&gt;
   &lt;filter-name&gt;LogFilter&lt;/filter-name&gt;
   &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

&lt;filter-mapping&gt;
   &lt;filter-name&gt;AuthenFilter&lt;/filter-name&gt;
   &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
</pre>
<h2>Filters Application Order:</h2>
<p>The order of filter-mapping elements in web.xml determines the order in which the web container applies the filter to the servlet. To reverse the order of the filter, you just need to reverse the filter-mapping elements in the web.xml file.</p>
<p>For example, above example would apply LogFilter first and then it would apply AuthenFilter to any servlet but the following example would reverse the order:</p>
<pre class="prettyprint">
&lt;filter-mapping&gt;
   &lt;filter-name&gt;AuthenFilter&lt;/filter-name&gt;
   &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

&lt;filter-mapping&gt;
   &lt;filter-name&gt;LogFilter&lt;/filter-name&gt;
   &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
</pre>
					</div>
					<!--// google ad -->
					<div style="padding-left:24px; padding-top: 12px;padding-bottom: 2px;">
						<script type="text/javascript">
							<!--
							google_ad_client ="ca-pub-1090193214637198";
							/* yiibai下方 */
							google_ad_slot = "6494738921";
							google_ad_width = 728;
							google_ad_height = 90;
							//-->
						</script>
						<script type="text/javascript"
						src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
					</div>
				</div><!--/span-->
				<!--// demos -->
				
				<div class="span9" style="width:800px; margin:12px 8px 12px 12px; padding: 8px 22px 8px 24px; border: 1px solid #DDDDDD;float:right;">
					<div style="width: 740px;height: 48px; margin:0px; padding: 0px; border-bottom: 1px solid #DDDDDD;">
						<h2 style="float:left;font-size: 13pt;width:490px;">贡献/合作者</h2>
					</div>
					<div style="text-align: left;float:left;width:660px;">
						正在开放中...
					</div>
				</div>

				<div class="span9" style="width:800px; margin:12px 8px 12px 12px; padding:0px; float:right;">
					<div style="float:left;width:780px;height: 160px;clear:both;">
						<div style="float:left;width:40px;height: 160px;">
							<img src="http://www.yiibai.com/static/ico/deault_user_icon.gif" width="32px;" height="32px;"/>
						</div>
						<div style="float:left;width:680px;height: 160px; margin-left:12px; clear:right;">
							<form action="servlets-writing-filters.html" method="post">
								<a name="comment"></a>
								<textarea id="comment_textarea" name="comment_content" style="height: 120px;">&nbsp;</textarea>
								<input type="button" class="btn btn-success" id="comment_submit" value="提交评论"/><span id="submit_tips" style="margin-left: 22px;padding-top: 2px;" class=""></span>
							</form>
						</div>
					</div>
					<div style="clear: both;padding:14px;">&nbsp;</div>
					<h2 style="float:left;font-size: 13pt;width:780px;border-bottom: 1px solid #DDDDDD;">评论(0条)</h2>

					<div style="width:780px;  float: left;">
						<ul style="margin: 5px 0 15px 0;padding: 5px 0 5px 0px;">
														<li style="border-bottom: 1px dashed #ddd; margin-top: 8px;margin-bottom: 8px;">
								<p>
									<span style="font-size: 10.5pt;">还没有评论！</span>
								</p>
							</li>
														
						</ul>
					</div>
				</div>

			</div><!--/row-->
		</div>
		<!--/yb_content-->
<hr style="padding-top:0px;margin-top: 18px; border-bottom-color: #33;"/>
<div style="margin:auto; width: 960px; text-align: center; margin: 12px 0px 36px 0;">
	<span>Copyright 2012-2015 © www.yiibai.com	 粤ICP备12018498号-3</span>
	<span style="padding-left:18px;">联系：<img title="联系Email" src="../static/img/contact_mail.png"></span>	
</div>

		<!--
		<script type="text/javascript">
		/*文章右侧悬浮*/
		var cpro_id = "u1167141";
		</script>
		<script src="http://cpro.baidustatic.com/cpro/ui/f.js" type="text/javascript"></script>
		-->
	</body>
	<script type="text/javascript" src="http://www.yiibai.com/static/js/tutorial.js"></script>
</html>