<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<meta http-equiv="Content-Language" content="zh-CN"/>
		<title>Servlet Exception Handling</title>
		<meta name="Keywords" content="Servlets,Servlet Exception Handling,Servlets-"/>
		<meta name="Description" content="Servlet Exception Handling"/>
		<!--//tutorial/base.view.html-->
		<script type="text/javascript" src="../static/js/jquery.js"></script>
		<link rel="stylesheet" href="http://www.yiibai.com/static/redactor/css/redactor.css" />
		<script src="http://www.yiibai.com/static/redactor/redactor.js"></script>
		<link href="../static/css/bootstrap.css" rel="stylesheet" type="text/css" />
		<link href="../static/css/tutorial.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript">
			$(document).ready(function() {
				var buttons = ['formatting', '|', 'bold', 'italic', '|', 'button1'];
				$('#comment_textarea').redactor({
					focus: false, 
					buttons: buttons, 					
				});
			});
		</script>
		<style>
			table {
				border: 1px solid #DDD;
				border-collapse: separate;
				border-left: 0;
				-webkit-border-radius: 4px;
				-moz-border-radius: 4px;
				border-radius: 4px;
				max-width: 90%;
				background-color: transparent;
				border-collapse: collapse;
				border-spacing: 0;
			}
			thead {
				display: table-header-group;
				vertical-align: middle;
				border-color: inherit;
				border-left: 1px solid #DDD;
			}
			th {
				font-weight: bold;
				border-left: 1px solid #DDD;
				line-height: 28px;
			}
			tbody {
				display: table-row-group;
				vertical-align: middle;
				border-color: inherit;
			}
			tr {
				display: table-row;
				vertical-align: inherit;
				border-color: inherit;
				border-left: 1px solid #DDD;
			}
			td {
				padding: 8px;
				line-height: 20px;
				text-align: left;
				vertical-align: top;
				border-top: 1px solid #DDD;
				border-left: 1px solid #DDD;
			}
		</style>
	</head>
	<body>
		<div class="header">
	<a href="../index.html" class="logo"> <img src="../static/img/logo.png" /> </a>
	<span class="input-append search" style="">
	<form action="http://www.yiibai.com/search" method="get" style="margin: 0px;">
		<input id="prependedDropdownButton" type="text" name="kw" class="span4 pub-share">
		<button class="btn pub-share" type="submit">
			搜 索
		</button>
	</form>
	</span>
	<a class="btn btn-success" href="../index.php?r=tutorial%252Fcreate">发起分享</a>
		<a href="../index.php?r=login" class="user-login">登陆</a>
	<a href="../index.php?r=register" class="user-register">注册</a>
	
		</span>
</div>


		<div class="header-nav">	<div id="menu" class="menu">		<div class="main-menu" style="clear:both;">			<ul>				<li class="">					<a href="../index.html" target="_self">首页</a>				</li>				<li id="all-category-e" class="all-category current">					<a href="http://www.yiibai.com/tutorial"  class="all-category current">教程</a>				</li>				<li>					<a href="http://www.yiibai.com/question">问题求助</a>				</li>				<li class="last">					<a class="last" href="http://www.yiibai.com/tag">标签</a>				</li>			</ul>		</div>	</div></div>
		<div class="exp-category-container">
	<ul class="exp-category-list clearfix">
		<li>
			<a href="../java" target="_blank" title="Java教程">Java</a>
		</li>
		<li>
			<a href="../python" target="_blank" title="Python教程">Python</a>
		</li>
		<li>
			<a href="../php" target="_blank" title="php教程">PHP</a>
		</li>
		<li>
			<a href="../perl" target="_blank" title="perl教程">Perl</a>
		</li>
		<li>
			<a href="../ruby.2" target="_blank" title="Ruby教程">Ruby</a>
		</li>
		<li>
			<a href="../mysql" target="_blank" title="MySQL教程">MySQL</a>
		</li>
		<li>
			<a href="../sql" target="_blank" title="SQL教程">SQL</a>
		</li>
		<li>
			<a href="../jdbc" target="_blank" title="JDBC教程">JDBC</a>
		</li>
		<li>
			<a href="../go" target="_blank" title="GO教程">Go语言</a>
		</li>
		
	</ul>
</div>
		<div class="container-fluid" style="width: 1080px;margin: auto; margin-top: 16px;">
			<div class="path" style="padding-top:2px; margin-top: 0px;margin-bottom: 14px;clear: both;">
				当前位置：<a href="../index.html">首页</a> » <a href="index.html">Servlet教程</a> » 
			</div>
			<div class="row-fluid">
				<div class="well span3" style="width:260px;">
					<ul class="nav nav-list">
						<li class="">
							<a href="index.html" style="font-size:12pt;">Servlet教程</a>
						</li>
						<li class="divider" style="margin-top: 0px;"></li>
																		<li style="padding-left: 8px;">
														<a href="servlets-overview.html">Servlets 概述</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-environment-setup.html">Servlets环境设置</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-life-cycle.html">Servlets Life Cycle</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-first-example.html">Servlets First Examples</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-form-data.html">Servlets Form Data</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-client-reques.html">Servlets Client HTTP Request</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-server-response.html">Servlets Server HTTP Response</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-http-status-codes.html">Servlets HTTP 1.1 Status Codes</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-writing-filters.html">Servlets Filters</a>
													</li>
																								<li class="active" style="font-size:11pt;padding-left: 8px;">
														<a href="servlets-exception-handling.html">Servlet Exception Handling</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-cookies-handling.html">Servlets Cookies Handling</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-session-tracking.html">Servlet Session Tracking</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-database-access.html">Servlets - Database Access</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-file-uploading.html">Servlet File Uploading</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-handling-date.html">Servlet Date Handling</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-page-redirec.html">Servlets Page Redirection</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-hits-counter.html">Servlets Page Hits Counter</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-auto-refres.html">Auto Page Refresh using Servlets</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-sending-email.html">Sending email using Servlets</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-packaging.html">Servlets Packaging</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-debugging.html">Servlets Debugging</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-internationalization.html">Servlets Internationalization| i18n| l10n| Servlets Localization</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="../index.html">Servlets Quick Guide</a>
													</li>
																								<li style="padding-left: 8px;">
														<a href="servlets-useful-resources.html">Servlets Useful Resources, Sites and Books</a>
													</li>
																	</ul>
				</div>
				<div class="span9" style="width:800px; margin-left:12px; padding: 0px; border: 1px solid #DDDDDD;float:left;">
					<div style="width: 760px;height:48px; padding: 2px 18px 2px 18px;text-align: left;border-bottom: 1px dashed #CCC;clear:both; ">
						<h1 style="font-size: 13.5pt;width: 645px;float:left; overflow: hidden;">Servlets - Exception Handling</h1>
						<span style="float:left;padding: 18px;margin-left: 12px;"><a href="servlets-exception-handling.html#comment" title="我要去评论">评论</a>&nbsp;&nbsp;<a href="http://www.yiibai.com/index.php?r=tutorial/updateVersion&id=3629" title="完善此教程实例">编辑</a></span>
						<input type="hidden" id="tid" value="3629"/>
					</div>

					<!--
					<div style="padding-left:24px; padding-top: 12px;padding-bottom: 2px;">
					<script type="text/javascript">
					<!--
					google_ad_client ="ca-pub-1090193214637198";
					/* yiibai上方 */
					google_ad_slot = "7899237394";
					google_ad_width = 728;
					google_ad_height = 90;
					//->
					</script>
					<script type="text/javascript"
					src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
					</div>
					-->
					<div id="baidu-ad" style="float:left;clear:both; width: 800px;padding-left:24px; padding-top: 6px;padding-bottom: 24px;">
						<script type="text/javascript">
						/*文章详细页上方628*90*/
						var cpro_id = "u1064372";
						</script>
						<script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
						
					</div>
					<div style="padding:8px 22px 8px 24px;" id="content">
						<p>When a servlet throws an exception, the web container searches the configurations in <b>web.xml</b> that use the exception-type element for a match with the thrown exception type.</p>
<p>You would have to use the <b>error-page</b> element in web.xml to specify the invocation of servlets in response to certain <b>exceptions</b> or HTTP <b>status codes</b>.</p>
<h2>web.xml Configuration:</h2>
<p>Consider, you have an <i>ErrorHandler</i> servelt which would be called whenever there is any defined exception or error. Following would be the entry created in web.xml.</p>
<pre class="prettyprint">
&lt;!-- servlet definition --&gt;
&lt;servlet&gt;
        &lt;servlet-name&gt;ErrorHandler&lt;/servlet-name&gt;
        &lt;servlet-class&gt;ErrorHandler&lt;/servlet-class&gt;
&lt;/servlet&gt;
&lt;!-- servlet mappings --&gt;
&lt;servlet-mapping&gt;
        &lt;servlet-name&gt;ErrorHandler&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/ErrorHandler&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;

&lt;!-- error-code related error pages --&gt;
&lt;error-page&gt;
    &lt;error-code&gt;404&lt;/error-code&gt;
    &lt;location&gt;/ErrorHandler&lt;/location&gt;
&lt;/error-page&gt;
&lt;error-page&gt;
    &lt;error-code&gt;403&lt;/error-code&gt;
    &lt;location&gt;/ErrorHandler&lt;/location&gt;
&lt;/error-page&gt;

&lt;!-- exception-type related error pages --&gt;
&lt;error-page&gt;
    &lt;exception-type&gt;
          javax.servlet.ServletException
    &lt;/exception-type &gt;
    &lt;location&gt;/ErrorHandler&lt;/location&gt;
&lt;/error-page&gt;

&lt;error-page&gt;
    &lt;exception-type&gt;java.io.IOException&lt;/exception-type &gt;
    &lt;location&gt;/ErrorHandler&lt;/location&gt;
&lt;/error-page&gt;
</pre>
<p>If you want to have a generic Error Handler for all the exceptions then you should define following error-page instead of defining separate error-page elements for every exception:</p>
<pre class="prettyprint">
&lt;error-page&gt;
    &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type &gt;
    &lt;location&gt;/ErrorHandler&lt;/location&gt;
&lt;/error-page&gt;
</pre>
<p>Following are the points to be noted about above web.xml for Exception Handling:</p>
<ul class="list">
<li><p>The servelt ErrorHandler is defined in usual way as any other servlet and configured in web.xml.</p></li>
<li><p>If there is any error with status code  either 404 ( Not Found) or 403 ( Forbidden ), then ErrorHandler servlet would be called.</p></li>
<li><p>If the web application throws either <i>ServletException</i> or <i>IOException</i>, then the web container invokes the /ErrorHandler servlet.</p></li>
<li><p>You can define different Error Handlers to handle different type of errors or exceptions. Above example is very much generic and hope it serve the purpose to explain you the basic concept.</p></li>
</ul>
<h2>Request Attributes - Errors/Exceptions:</h2>
<p>Following is the list of request attributes that an error-handling servlet can access to analyse the nature of error/exception.</p>
<table class="src">
<tr><th style="width:5%">S.N.</th><th>Attribute &amp; Description</th></tr>
<tr><td>1</td><td><b>javax.servlet.error.status_code</b><br />This attribute give status code which can be stored and analysed after storing in a java.lang.Integer data type.</td></tr>
<tr><td>2</td><td><b>javax.servlet.error.exception_type</b><br />This attribute gives information about exception type which can be stored and analysed after storing in a java.lang.Class data type.</td></tr>
<tr><td>3</td><td><b>javax.servlet.error.message</b><br />This attribute gives information exact error message which can be stored and analysed after storing in a java.lang.String data type.</td></tr>
<tr><td>4</td><td><b>javax.servlet.error.request_uri</b><br />This attribute gives information about URL calling the servlet and it can be stored and analysed after storing in a java.lang.String data type.</td></tr>
<tr><td>5</td><td><b>javax.servlet.error.exception</b><br />This attribute gives information the exception raised which can be stored and analysed after storing in a java.lang.Throwable data type.</td></tr>
<tr><td>6</td><td><b>javax.servlet.error.servlet_name</b><br />This attribute gives servlet name which can be stored and analysed after storing in a java.lang.String data type.</td></tr>
</table>
<h2>Error Handler Servlet Example:</h2>
<p>Following is the Servlet Example that would be used as Error Handler in case of any error or exception occurs with your any of the servlet defined.</p>
<p>This example would give you basic understanding of Exception Handling in Servlet, but you can write more sophisticated filter applications using the same concept:</p>
<pre class="prettyprint">
// Import required java libraries
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import java.util.*;

// Extend HttpServlet class
public class ErrorHandler extends HttpServlet {
 
  // Method to handle GET method request.
  public void doGet(HttpServletRequest request,
                    HttpServletResponse response)
            throws ServletException, IOException
  {
      // Analyze the servlet exception       
      Throwable throwable = (Throwable)
      request.getAttribute("javax.servlet.error.exception");
      Integer statusCode = (Integer)
      request.getAttribute("javax.servlet.error.status_code");
      String servletName = (String)
      request.getAttribute("javax.servlet.error.servlet_name");
      if (servletName == null){
         servletName = "Unknown";
      }
      String requestUri = (String)
      request.getAttribute("javax.servlet.error.request_uri");
      if (requestUri == null){
         requestUri = "Unknown";
      }

      // Set response content type
      response.setContentType("text/html");
 
      PrintWriter out = response.getWriter();
	  String title = "Error/Exception Information";
      String docType =
      "&lt;!doctype html public \"-//w3c//dtd html 4.0 " +
      "transitional//en\"&gt;\n";
      out.println(docType +
        "&lt;html&gt;\n" +
        "&lt;head&gt;&lt;title&gt;" + title + "&lt;/title&gt;&lt;/head&gt;\n" +
        "&lt;body bgcolor=\"#f0f0f0\"&gt;\n");

      if (throwable == null &amp;&amp; statusCode == null){
         out.println("&lt;h2&gt;Error information is missing&lt;/h2&gt;");
         out.println("Please return to the &lt;a href=\"" + 
           response.encodeURL("http://localhost:8080/") + 
           "\"&gt;Home Page&lt;/a&gt;.");
      }else if (statusCode != null){
         out.println("The status code : " + statusCode);
      }else{
         out.println("&lt;h2&gt;Error information&lt;/h2&gt;");
         out.println("Servlet Name : " + servletName + 
                             "&lt;/br&gt;&lt;/br&gt;");
         out.println("Exception Type : " + 
                             throwable.getClass( ).getName( ) + 
                             "&lt;/br&gt;&lt;/br&gt;");
         out.println("The request URI: " + requestUri + 
                             "&lt;br&gt;&lt;br&gt;");
         out.println("The exception message: " + 
                                 throwable.getMessage( ));
      }
      out.println("&lt;/body&gt;");
      out.println("&lt;/html&gt;");
  }
  // Method to handle POST method request.
  public void doPost(HttpServletRequest request,
                     HttpServletResponse response)
      throws ServletException, IOException {
     doGet(request, response);
  }
}
</pre>
<p>Compile <b>ErrorHandler.java</b> in usual way and put your class file in &lt;Tomcat-installation-directory&gt;/webapps/ROOT/WEB-INF/classes.</p>
<p>Let us add the following configuration in web.xml to handle exceptions:</p>
<pre class="prettyprint">
&lt;servlet&gt;
        &lt;servlet-name&gt;ErrorHandler&lt;/servlet-name&gt;
        &lt;servlet-class&gt;ErrorHandler&lt;/servlet-class&gt;
&lt;/servlet&gt;
&lt;!-- servlet mappings --&gt;
&lt;servlet-mapping&gt;
        &lt;servlet-name&gt;ErrorHandler&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/ErrorHandler&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
&lt;error-page&gt;
    &lt;error-code&gt;404&lt;/error-code&gt;
    &lt;location&gt;/ErrorHandler&lt;/location&gt;
&lt;/error-page&gt;
&lt;error-page&gt;
    &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type &gt;
    &lt;location&gt;/ErrorHandler&lt;/location&gt;
&lt;/error-page&gt;
</pre>
<p>Now try to use a servlet which raise any exception or type a wrong URL, this would trigger Web Container to call <b>ErrorHandler</b> servlet and display an appropriate message as programmed. For example, if you type a wrong URL then it would display the following result:</p>
<pre class="prettyprint">
The status code : 404
</pre>
<p>Above code may not work with some web browsers. So try with Mozilla and Safari and it should work.</p>
					</div>
					<!--// google ad -->
					<div style="padding-left:24px; padding-top: 12px;padding-bottom: 2px;">
						<script type="text/javascript">
							<!--
							google_ad_client ="ca-pub-1090193214637198";
							/* yiibai下方 */
							google_ad_slot = "6494738921";
							google_ad_width = 728;
							google_ad_height = 90;
							//-->
						</script>
						<script type="text/javascript"
						src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
					</div>
				</div><!--/span-->
				<!--// demos -->
				
				<div class="span9" style="width:800px; margin:12px 8px 12px 12px; padding: 8px 22px 8px 24px; border: 1px solid #DDDDDD;float:right;">
					<div style="width: 740px;height: 48px; margin:0px; padding: 0px; border-bottom: 1px solid #DDDDDD;">
						<h2 style="float:left;font-size: 13pt;width:490px;">贡献/合作者</h2>
					</div>
					<div style="text-align: left;float:left;width:660px;">
						正在开放中...
					</div>
				</div>

				<div class="span9" style="width:800px; margin:12px 8px 12px 12px; padding:0px; float:right;">
					<div style="float:left;width:780px;height: 160px;clear:both;">
						<div style="float:left;width:40px;height: 160px;">
							<img src="http://www.yiibai.com/static/ico/deault_user_icon.gif" width="32px;" height="32px;"/>
						</div>
						<div style="float:left;width:680px;height: 160px; margin-left:12px; clear:right;">
							<form action="servlets-exception-handling.html" method="post">
								<a name="comment"></a>
								<textarea id="comment_textarea" name="comment_content" style="height: 120px;">&nbsp;</textarea>
								<input type="button" class="btn btn-success" id="comment_submit" value="提交评论"/><span id="submit_tips" style="margin-left: 22px;padding-top: 2px;" class=""></span>
							</form>
						</div>
					</div>
					<div style="clear: both;padding:14px;">&nbsp;</div>
					<h2 style="float:left;font-size: 13pt;width:780px;border-bottom: 1px solid #DDDDDD;">评论(0条)</h2>

					<div style="width:780px;  float: left;">
						<ul style="margin: 5px 0 15px 0;padding: 5px 0 5px 0px;">
														<li style="border-bottom: 1px dashed #ddd; margin-top: 8px;margin-bottom: 8px;">
								<p>
									<span style="font-size: 10.5pt;">还没有评论！</span>
								</p>
							</li>
														
						</ul>
					</div>
				</div>

			</div><!--/row-->
		</div>
		<!--/yb_content-->
<hr style="padding-top:0px;margin-top: 18px; border-bottom-color: #33;"/>
<div style="margin:auto; width: 960px; text-align: center; margin: 12px 0px 36px 0;">
	<span>Copyright 2012-2015 © www.yiibai.com	 粤ICP备12018498号-3</span>
	<span style="padding-left:18px;">联系：<img title="联系Email" src="../static/img/contact_mail.png"></span>	
</div>

		<!--
		<script type="text/javascript">
		/*文章右侧悬浮*/
		var cpro_id = "u1167141";
		</script>
		<script src="http://cpro.baidustatic.com/cpro/ui/f.js" type="text/javascript"></script>
		-->
	</body>
	<script type="text/javascript" src="http://www.yiibai.com/static/js/tutorial.js"></script>
</html>